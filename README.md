Dockerconstp
# Основные команды Docker

* ``docker version`` - показывает информацию о клиенте и сервере докер
* ``docker ps -a`` - показывает сипсок запущенных и остановленных контейнеров
* ``docker images`` - показывает список локальных образов
* ``docker run название образа : версия(по умолчанию latest)`` - создает и запускает контейнер(если локально образа нет то скачет)
* ``docker pull название образа ``-  скачать образ с DockerHub
* ``docker rm id_контейнера `` - удаляет контейнер
* ``docker container prune`` - удалить все контейнеры
* ``docker run -it busybox`` - подключаеться к интерактивному терминалу (ключи -it)
* ``docker run -d nginx`` - Запуск контейнера в фоновом режиме (ключ -d)
* ``docker container inspect id_контейнера | grep ipadress(grep фильтрация вывода)``-  информация о контейнере
* ``docker stop id_контейнера`` - останавливает выбранный контейнер
* ``docker exec -it id_контейнера bash (название процесса)`` - выполняет команду в запущеном контейнере
* ``docker run -d --name my_nginx nginx`` - создает контейнер с именем  my_nginx
* ``docker logs id_контейнера`` - показывает логи контейнера
---
## Мепинг портов
* ``docker run -d -p 8080:80 nginx `` - создает и запускает контайнер -p ключ публикации порта 8080 *(внешний порт)*:80 *(порт контейнера)*  nginx *(название контейнера)*
---
## Меппинг томов
* ``docker run -v ``*(Также можно использовать абсолютный путь)*`` ${PWD}:/usr/share/nginx/html nginx``- создает и запускает контейнер -v (подключение тома) ${PWD *(путь к локльной папке в которй щас находишься )* }:/usr/share/nginx/html *(путь к папке внутри контейнера)* nginx *(название контейнера)*
---
* ``docker run -it --rm busybox`` - создает и запускает контейнер , после остановки контейнер удаляеться сам (опция --rm)
---
## Разбиение команды на строки

```
    docker run \
    --name my_nginx \
    -v ${PWD}:/usr/share/nginx/html \
    -p 8080:80 \
    -d \
    --rm \
    nginx
  ```
---
# Этапы создания образов

* Для создания образа необходим Dockerfile
* обычно Dockerfile помещают в корень папки приложения
* Dockerfile содерижит инструкции по созданию образа
* При создании можно указать имя и тег для образа
* На основании готового образа можно создать контейнер

### Dockerfile
```
FROM python:alpine //имя python : тэг(версия) alpine базовго образа
WORKDIR /app // создаеться рабочая директория внутри образа /app
COPY . . // копируем файлы из текущий папки локальной машины в рабочую директроию контейнера
CMD ["python" , "main.py"] // выполнение команды после создания образа (python процесс который запуститься в контейнере )

```
* ``docker build путь к dockerfile -t me_calendary:4.4.1 `` - Запустить создание образа на основе dockerfile *(ключ -t добавление **имени : тэга** для образа)*
---
# Docker Compose

## Формат yaml

* Список
  ```
  fruits:
   -banana
   -orange
   -apple
  ```
* Словарь
```
pen:
  color:yellow
  model:
    type: pen
    material:plastic
  price:2
```
## Преимущества Docker compose

* **Декларативный** подход к созданию контейнеров
* Все необходимые контейнеры запускаюсть **одной командой**
* Автоматическое создание необходимых образов на основе **Dockerfile** каждого приложения
* Автоматическое создание изолированной **сети** для взаимодействия контейнеров
* Благодаря **DNS** возможновзаимодействие между контейнерами , используя **имена сервисов**

## Пример Docker-compose.yaml
```
version: '3'

services:
  app:   // Название сервиса
    build: ./app // Включает этап создания образа
  mongo: // Название сервиса
    image: mongo // название образа

```
* ``docker-compose up `` - создает и запускает контейнеры по инструкции из файла docker-compose.yml
* ``docker-compose up -d`` - запуск в фоновом режиме
* ``docker-compose down`` - остановка и удаление всех контейнеров связанных  с docker-compose
* ``docker-compose up -d --build`` - Пересборка после внесения изменений
